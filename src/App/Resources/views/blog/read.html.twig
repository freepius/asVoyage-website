{% set currentNav = 'blog' %}

{% extends "layout.html.twig" %}


{% block main %}

<article itemscope itemtype="http://schema.org/BlogPosting" class="with-aside">

    <header>
        <!-- Breadcrumb -->
        <nav itemprop="breadcrumb">
            {# Link to Blog home page #}
            {% set url = '/blog' %}
            <a href="{{ url }}">{{ 'blog.home'|trans }}</a> »

            {# Eventual link to filtered Blog home page #}
            {% if hasTagFilter %}
                {% set url = '/blog/tag-' ~tag %}

                <a href="{{ url }}">
                    {{ 'blog.having-tag' | trans([tag]) | raw }}</a> »

            {% elseif hasYearFilter %}
                {% set url = '/blog/year-' ~year %}

                <a href="{{ url }}">
                    {{ 'blog.having-year' | trans([year]) | raw }}</a> »

            {% elseif hasMonthFilter %}
                {% set url = '/blog/year-' ~year~ '/month-' ~month %}

                <a href="{{ url }}">
                    {{ 'blog.having-year-month' | trans([year, ('month.'~month)|trans]) | raw }}</a> »
            {% endif %}

            {# Eventual link to Blog home page by page number #}
            {% if hasPage %}
                <a href="{{ url ~'/'~ page }}">{{ 'blog.page-number' | trans([page]) }}</a> »
            {% endif %}
        </nav>

        <!-- Title -->
        <h1 itemprop="name" id="page-title">{{ article.title }}</h1>
    </header>

    <div itemprop="articleBody">
        {{ article.text | raw }}
    </div>

    <!-- Comments -->
    <div itemprop="comment">
        <h2>{{ 'Comments'|trans }}</h2>

        {% include 'comment/list.html.twig' with {
                url_prefix: '/blog/'~article.slug~'/read', comments: article.comments,
                idComment: idComment, comment: comment, errors: errors
           } only
        %}
    </div>

</article>


<aside>
    <!-- Publication datetime + Tags + Actions on article -->
    <div class="box">
        <p>
            <time itemprop="datePublished" datetime="{{ article.pubdatetime }}">
                {{ article.pubdatetime | localizeddate('full') | capitalize }}
            </time>
        </p>

        <p>
            <b>{{ 'blog.field.tags'|trans }} :</b>

            {% if article.tags is empty %}
                {{ 'none'|trans }}
            {% else %}
                <span itemprop="keywords">{{ article.tags | join(', ') }}</span>
            {% endif %}
        </p>

        {% if is_granted('ROLE_ADMIN') %}
        <div>
            <!-- Update -->
            <a href="/blog/{{- article.slug -}}/update" title="{{ 'Update'|trans }}">
                <i class="icon-pencil"></i></a>

            <!-- Delete -->
            <a href="/blog/{{- article.slug -}}/delete" title="{{ 'Delete'|trans }}">
                <i class="icon-trash"></i></a>
        </div>
        {% endif %}
    </div>
</aside>

{% endblock %}
